<div class="corporate-dialog-container">
    
    <div class="dialog-header bg-slate-50 border-b border-slate-200 px-6 py-4 flex justify-between items-center">
        <h2 class="text-lg font-bold text-slate-800 uppercase tracking-wide m-0 flex items-center gap-2">
            <i class="bi bi-person-vcard text-blue-800"></i> {{data.mode == 'actualizar' ? 'Actualizar Asegurado': 'Nuevo Asegurado'}}
        </h2>
        <button mat-icon-button mat-dialog-close class="text-slate-400 hover:text-red-600 transition-colors">
            <mat-icon><i class="bi bi-x-lg"></i></mat-icon>
        </button>
    </div>

    <form (ngSubmit)="GuardarAsegurado()" [formGroup]="form" class="flex flex-col h-full">
        
        <mat-dialog-content class="!p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2">

                <mat-form-field *ngIf="!ocultar"  class="w-full col-span-2 md:col-span-2" [hidden]="ocultar">
                    <mat-label>ID Interno</mat-label>
                    <input matInput formControlName="id" readonly="true" class="bg-gray-50 text-gray-500 font-bold"/>
                </mat-form-field>

                <mat-form-field appearance="fill" class="w-full col-span-2 md:col-span-2">
                    <mat-label>Cédula</mat-label>
                    <input matInput formControlName="cedula" maxlength="10" (input)="onInput($event)"  />
                    <mat-icon matSuffix class="text-gray-400">badge</mat-icon>
                    <mat-error *ngIf="form?.get('cedula')?.hasError('required')">
                        Requerido
                    </mat-error>
                </mat-form-field>

                <div class="col-span-1 md:col-span-2">
                    <mat-form-field appearance="fill" class="w-full">
                        <mat-label>Nombre Completo</mat-label>
                        <input matInput formControlName="nmbrcompleto" maxlength="75" placeholder="Nombres y Apellidos" />
                        <mat-icon matSuffix class="text-gray-400">person</mat-icon>
                        <mat-error *ngIf="form?.get('nmbrcompleto')?.hasError('required')">
                            Requerido
                        </mat-error>
                    </mat-form-field>
                </div>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Teléfono Contacto</mat-label>
                    <input matInput formControlName="telefono" maxlength="10" (input)="onInput($event)" placeholder="099..." />
                    <mat-icon matSuffix class="text-gray-400">phone</mat-icon>
                    <mat-error *ngIf="form?.get('telefono')?.hasError('required')">
                        Requerido
                    </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Edad Actual</mat-label>
                    <input matInput formControlName="edad" maxlength="2" (input)="onInput($event)" />
                    <span matSuffix class="text-xs text-gray-500 mr-2">años</span>
                    <mat-error *ngIf="form?.get('edad')?.hasError('required')">
                        Requerido
                    </mat-error>
                </mat-form-field>

                <div class="col-span-1 md:col-span-2" [hidden]="ocultarseg">
                    <mat-form-field appearance="fill" class="w-full">
                        <mat-label>Asignar Póliza de Seguro</mat-label>
                        <mat-select formControlName="segdisponibles">
                            <mat-option *ngFor="let estado of getseguros" [value]="estado.value">
                                {{ estado.label }}
                            </mat-option>
                        </mat-select>
                        <mat-icon matSuffix class="text-blue-800">verified_user</mat-icon>
                        <mat-error *ngIf="form?.get('segdisponibles')?.hasError('required')">
                            Debe seleccionar un seguro
                        </mat-error>
                    </mat-form-field>
                </div>

            </div>
        </mat-dialog-content>

        <mat-dialog-actions align="end" class="!px-6 !py-4 bg-gray-50 border-t border-gray-200">
            <button mat-stroked-button mat-dialog-close type="button" class="!border-slate-300 !text-slate-600 !mr-2">
                Cancelar
            </button>
            
            <button mat-flat-button 
                    type="submit" 
                    [disabled]="!form.valid || isLoading" 
                    class="btn-save-corporate">
                
                <div class="flex items-center justify-center gap-2">
                    <mat-icon *ngIf="!isLoading" class="text-sm">save</mat-icon>
                    <span>GUARDAR DATOS</span>
                    
                    <div *ngIf="isLoading" class="loader-wrapper">
                         <svg class="spinner-mini" viewBox="0 0 50 50">
                            <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
                        </svg>
                    </div>
                </div>
            </button>
        </mat-dialog-actions>
    </form>
</div>